(this["webpackJsonplove-the-args"]=this["webpackJsonplove-the-args"]||[]).push([[0],{111:function(e,t,n){},117:function(e,t,n){},218:function(e,t,n){},221:function(e,t,n){},225:function(e,t,n){},226:function(e,t,n){},232:function(e,t,n){},233:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n(25),r=n.n(c),a=(n(111),n(4)),s=(n(117),n(105)),i=n.n(s),l=(n(49),n(1));function d(e){var t=e.id,n=Object(a.c)((function(e){return e.blocks.present.notes[t]})),o=Object(a.c)((function(e){return e.blocks.present.views[t]})),c=Object(a.b)();return!1===o||void 0===o?Object(l.jsx)("div",{}):Object(l.jsx)(i.a,{id:t,class:"note",onSelect:function(){return c({type:"updateNote",payload:{id:t}})},onChange:function(){return c({type:"updateNote",payload:{id:t}})},onClick:function(e){if(e.ctrlKey||e.metaKey||e.shiftKey)return 0;c({type:"updateNote",payload:{id:t}})},value:n})}function u(e){var t=e.id,n=Object(a.b)();return Object(l.jsxs)("label",{className:"switch",children:[Object(l.jsx)("input",{type:"checkbox",onChange:function(){return n({type:"toggleNote",payload:{id:t}})}}),Object(l.jsx)("span",{className:"slider round"})]})}var b=n(48),j=n(5);function p(e){var t=e.getSelection().getAnchorOffset(),n=e.getCurrentContent().getPlainText().length,o=e.getSelection().getAnchorKey(),c=e.getCurrentContent().getLastBlock().key,r=e.getCurrentContent().getFirstBlock().key,a=j.SelectionState.createEmpty("blockkey").merge({anchorKey:o,anchorOffset:t,focusOffset:n,focusKey:c}),s=j.SelectionState.createEmpty("blockkey").merge({anchorKey:r,anchorOffset:0,focusKey:o,focusOffset:t}),i=j.Modifier.removeRange(e.getCurrentContent(),s,"forward"),l=j.Modifier.removeRange(e.getCurrentContent(),a,"forward");return{slice1:JSON.stringify(Object(j.convertToRaw)(l)),slice2:JSON.stringify(Object(j.convertToRaw)(i))}}function O(e){var t=e.getSelection(),n=t.getAnchorOffset()<t.getFocusOffset();return n?{anchorKey:t.getAnchorKey(),anchorOffset:t.getAnchorOffset(),focusKey:t.getFocusKey(),focusOffset:t.getFocusOffset(),isBackward:n}:{anchorKey:t.getFocusKey(),anchorOffset:t.getFocusOffset(),focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset(),isBackward:n}}var f={TANNA:{color:"blue"},AMORA:{color:"green"},AMORA_MIDRASH:{color:"aqua"},STAM:{color:"purple"},STAM_MIDRASH:{color:"orange"},CLEAR:{color:"black"}};function g(e){var t=e.id,n=Object(a.c)((function(e){return e.blocks.present.txts}))[t],c=j.EditorState.createWithContent(Object(j.convertFromRaw)(JSON.parse(n))),r=Object(o.useState)((function(){return j.EditorState.createWithContent(Object(j.convertFromRaw)(JSON.parse(n)))})),s=Object(b.a)(r,2),i=s[0],d=s[1],u=Object(a.b)();c.getCurrentContent().getPlainText()!==i.getCurrentContent().getPlainText()&&(console.log("infinite loop1"),d(c)),n!==JSON.stringify(Object(j.convertToRaw)(i.getCurrentContent()))&&(console.log("infinite loop3"),d(c));var g=0;return Object(o.useEffect)((function(){var e=document.activeElement;"notranslate public-DraftEditor-content"===e.getAttribute("class")&&e.parentElement.parentElement.parentElement.getAttribute("id")===t&&g.focus()})),Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("div",{className:"text_editor",id:t,children:Object(l.jsx)(j.Editor,{ref:function(e){return g=e},customStyleMap:f,editorState:i,onChange:function(e){var n=e.getCurrentContent().getPlainText()===i.getCurrentContent().getPlainText();d(e),u(n?{type:"updateSelection",payload:{id:t,split:p(e),selection:O(e)}}:{type:"updateText",payload:{id:t,txt:JSON.stringify(Object(j.convertToRaw)(e.getCurrentContent())),split:p(e),selection:O(e)}})}})})})}function y(){return Object(a.c)((function(e){return e.blocks.present.order})).map((function(e){return Object(l.jsxs)("div",{className:"block",children:[Object(l.jsx)(u,{id:e}),Object(l.jsx)(g,{id:e}),Object(l.jsx)(d,{id:e})]},e)}))}n(218);var h=n(28),m=n.n(h);function v(){var e=Object(a.b)();return Object(l.jsx)("button",{type:"button",onMouseDown:function(t){if(t.preventDefault(),"notranslate public-DraftEditor-content"===document.activeElement.getAttribute("class")){var n=document.activeElement.parentElement.parentElement.parentElement.id;e({type:"mergeText",payload:{id:n}})}},children:"merge"})}function x(){var e=Object(a.b)();return Object(l.jsx)("button",{type:"button",onMouseDown:function(t){if(t.preventDefault(),"notranslate public-DraftEditor-content"===document.activeElement.getAttribute("class")){var n=document.activeElement.parentElement.parentElement.parentElement.id;e({type:"splitText",payload:{id:n}})}},children:"split"})}function S(){var e=Object(a.b)();return Object(l.jsx)("button",{type:"button",onClick:function(){return e(h.ActionCreators.redo())},children:"redo"})}function C(){var e=Object(a.b)();return Object(l.jsx)("button",{type:"button",onClick:function(){e(h.ActionCreators.undo())},children:"undo"})}function A(e){var t=Object(a.b)(),n=Object(a.c)((function(e){return e.blocks.present.txts})),o=Object(a.c)((function(e){return e.blocks.present.selections}));return Object(l.jsx)("button",{type:"button","data-style":e.dataStyle,onMouseUp:function(e){return e.preventDefault()},onMouseDown:function(e){if(e.preventDefault(),"notranslate public-DraftEditor-content"===document.activeElement.getAttribute("class")){var c=e.currentTarget.getAttribute("data-style"),r=document.activeElement.parentElement.parentElement.parentElement.id,a=Object(j.convertFromRaw)(JSON.parse(n[r])),s=function(e){var t=e.anchorKey,n=e.anchorOffset,o=e.focusKey,c=e.focusOffset;return j.SelectionState.createEmpty("blockkey").merge({anchorKey:t,anchorOffset:n,focusKey:o,focusOffset:c,isBackward:!1})}(o[r]);console.log("prior to update: ",s.getAnchorKey(),s.getAnchorOffset());var i=j.EditorState.createWithContent(a);i=j.EditorState.acceptSelection(i,s),i=k(i),i=j.RichUtils.toggleInlineStyle(i,c),console.log("after update:",i.getSelection().getAnchorKey(),i.getSelection().getAnchorOffset()),t({type:"updateText",payload:{id:r,txt:JSON.stringify(Object(j.convertToRaw)(i.getCurrentContent())),split:p(i),selection:O(i)}})}},children:e.name})}function w(){return Object(l.jsxs)("div",{className:"header_buttons",children:[Object(l.jsx)(C,{}),Object(l.jsx)(S,{}),Object(l.jsx)(v,{}),Object(l.jsx)(x,{}),Object(l.jsx)(A,{dataStyle:"TANNA",name:"Tannaitic"}),Object(l.jsx)(A,{dataStyle:"AMORA",name:"Amoraic"}),Object(l.jsx)(A,{dataStyle:"AMORA_MIDRASH",name:"Tannaitic from Amora"}),Object(l.jsx)(A,{dataStyle:"STAM",name:"Stam"}),Object(l.jsx)(A,{dataStyle:"STAM_MIDRASH",name:"Tannaitic from Stam"}),Object(l.jsx)(A,{dataStyle:"CLEAR",name:"Clear"})]})}var k=function(e){var t=e.getCurrentContent(),n=["TANNA","AMORA","AMORA_MIDRASH","STAM","STAM_MIDRASH","CLEAR"].reduce((function(t,n){return j.Modifier.removeInlineStyle(t,e.getSelection(),n)}),t);return j.EditorState.push(e,n,"change-inline-style")},E=(n(221),n(15)),N=n(106),T=n.n(N),M=(n(225),{"\u05de\u05e7\u05e8\u05d4":{color:"MidnightBlue",types:["arrow","box"]},"\u05d3\u05d9\u05df":{color:"CadetBlue",types:["arrow"]},"\u05d8\u05e2\u05dd":{color:"DarkSlateGrey",types:["arrow"]},"\u05db\u05d5\u05ea\u05e8\u05ea":{color:"DarkSlateBlue",types:["arrow","box"]},"\u05de\u05e2\u05e9\u05d4":{color:"LightSlateGrey",types:["arrow","box"]},"\u05d0\u05de\u05d9\u05e8\u05d4":{color:"DarkGreen",types:["arrow","box"]},"\u05e9\u05d0\u05dc\u05d4":{color:"Olive",types:["arrow","box"]},"\u05ea\u05e9\u05d5\u05d1\u05d4":{color:"YellowGreen",types:["arrow"]},"\u05e7\u05d5\u05e9\u05d9\u05d0":{color:"Tomato",types:["arrow"]},"\u05ea\u05d9\u05e8\u05d5\u05e5":{color:"OrangeRed",types:["arrow"]},"\u05e8\u05d0\u05d9\u05d4":{color:"DarkOrange",types:["arrow"]},"\u05e1\u05d9\u05d5\u05e2":{color:"Gold",types:["arrow"]},"\u05d0\u05d2\u05d3\u05d4":{color:"IndianRed",types:["arrow","box"]},"\u05d0\u05d5\u05e7\u05d9\u05de\u05ea\u05d0":{color:"DarkSalmon",types:["arrow"]}}),R={mishnah:["\u05de\u05e7\u05e8\u05d4","\u05d3\u05d9\u05df","\u05d8\u05e2\u05dd","\u05db\u05d5\u05ea\u05e8\u05ea","\u05de\u05e2\u05e9\u05d4"],talmud:["\u05d0\u05de\u05d9\u05e8\u05d4","\u05e9\u05d0\u05dc\u05d4","\u05ea\u05e9\u05d5\u05d1\u05d4","\u05e7\u05d5\u05e9\u05d9\u05d0","\u05ea\u05d9\u05e8\u05d5\u05e5","\u05e8\u05d0\u05d9\u05d4","\u05e1\u05d9\u05d5\u05e2","\u05d0\u05d2\u05d3\u05d4","\u05d0\u05d5\u05e7\u05d9\u05de\u05ea\u05d0"]},D="node_menu";function K(){var e=function(e,t,n){var o=t.target,c=t.label,r=t.type,a=t.dispatch,s=o.id;a("arrow"===r?{type:"setMode",payload:{label:c,id:s}}:{type:"setBox",payload:{label:c,id:s}})},t=Object(a.b)();return Object(l.jsxs)(E.a,{id:D,className:"context-menu",children:[Object(l.jsx)(E.c,{onClick:function(e,t,n){var o=t.target;(0,t.dispatch)({type:"removeBox",payload:{id:o.id}})},data:{dispatch:t},children:"Remove Box"},"remove"),Object.keys(R).map((function(n){return Object(l.jsx)(E.d,{title:n,children:R[n].map((function(n){return Object(l.jsx)(E.d,{title:n,children:M[n].types.map((function(o){return Object(l.jsx)(E.c,{onClick:e,data:{label:n,type:o,dispatch:t},children:o},o)}))},n)}))},n)}))]})}n(226);var _=function(e){var t=e.id,n=Object(a.b)(),o=Object(a.c)((function(e){return e.blocks.present.positions[t]})),c=Object(a.c)((function(e){return e.blocks.present.txts[t]})),r=Object(a.c)((function(e){return e.blocks.present.graph.boxes[t]})),s="";s=r?M[r].color:"";var i=function(e,t){n({type:"updatePosition",payload:{id:e.srcElement.id,x:t.lastX+t.deltaX,y:t.lastY+t.deltaY}})},d=Object(b.a)(o,2),u=d[0],p=d[1];return Object(l.jsx)(E.b,{id:D,children:Object(l.jsx)(T.a,{onStop:i,onDrag:i,defaultPosition:{x:u,y:p},children:Object(l.jsxs)("fieldset",{className:"node",id:t,style:{borderColor:s},children:[Object(l.jsx)("legend",{className:"label",style:{color:s},children:r}),Object(l.jsx)(j.Editor,{readOnly:!0,customStyleMap:f,editorState:j.EditorState.createWithContent(Object(j.convertFromRaw)(JSON.parse(c))),onChange:function(){}})]})},t)},t)};function F(){return Object(a.c)((function(e){return e.blocks.present.order})).map((function(e){return Object(l.jsx)(_,{id:e},e)}))}var B=n(33),I=n.n(B);function P(){for(var e=Object(a.c)((function(e){return e.blocks.present.order})),t=(Object(a.c)((function(e){return e.blocks.present.positions})),{}),n=0;n<e.length-1;n+=1)t[e[n]]=e[n+1];var o=[];return Object.keys(t).forEach((function(e){return o.push(Object(l.jsx)(I.a,{start:e,end:t[e],strokeWidth:1,lineColor:"grey",headColor:"grey",dashness:!0},e))})),o}var J="connection_menu";function L(){var e=Object(a.b)();return Object(l.jsx)(E.a,{id:J,children:Object(l.jsx)(E.c,{onClick:function(e,t,n){var o=t.target,c=t.reducerType;(0,t.dispatch)({type:c,payload:{id:o.parentElement.parentElement.id}})},data:{reducerType:"deleteConnection",dispatch:e},children:"Delete"},"deleteConnection")})}function W(){var e=Object(a.c)((function(e){return e.blocks.present.graph})),t=Object(a.b)();return Object(o.useEffect)((function(){function n(n){return function(e,t,n){switch(e.target.classList[0]){case"react-contextmenu-item":break;case"node":null!==t.selectedNode&&(t.selectedNode===e.target.id||t.connections.includes([t.selectedNode,e.target.id])||n({type:"addConnection",payload:{connection:[t.selectedNode,e.target.id,t.mode]}})),n({type:"resetMode"});break;default:n({type:"resetMode"})}}(n,e,t)}return document.addEventListener("click",n),function(){document.removeEventListener("click",n)}}),[e]),Object(l.jsx)(l.Fragment,{})}n(232);function H(){var e=Object(a.c)((function(e){return e.blocks.present.graph.connections})),t=(Object(a.c)((function(e){return e.blocks.present.positions})),{});return e.map((function(e){var n=e[0],o=e[1],c=e[2];t.hasOwnProperty(n)?t[n]+=1:t[n]=1,t.hasOwnProperty(o)?t[o]+=1:t[o]=1;var r=t[n];r%2===0?r/=-2:(r+=1,r/=2);var a=t[o];a%2===0?a/=-2:(a+=1,a/=2);t[n];return console.log(c,M),Object(l.jsx)(E.b,{id:J,children:Object(l.jsx)(I.a,{id:n+o+c,start:n,end:o,startAnchor:[{position:"right",offset:{bottomness:10*r,rightness:0}},{position:"left",offset:{bottomness:10*r,rightness:0}},{position:"bottom",offset:{bottomness:0,rightness:10*r}},{position:"top",offset:{bottomness:0,rightness:10*r}}],endAnchor:[{position:"right",offset:{bottomness:10*a,rightness:0}},{position:"left",offset:{bottomness:10*a,rightness:0}},{position:"bottom",offset:{bottomness:0,rightness:10*a}},{position:"top",offset:{bottomness:0,rightness:10*a}}],strokeWidth:3,headSize:5,lineColor:M[c].color,headColor:M[c].color,arrowBodyProps:{className:"arrow_body"},arrowHeadProps:{className:"arrow_head"},SVGcanvasProps:{className:"svg"},label:{middle:Object(l.jsx)("div",{className:"arrow_label",style:{color:M[c].color,transform:"translate(100%, 0%)"},children:c[0]})}},n+o+c)},n+o+c)}))}var G=function(){return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)("div",{className:"graph",children:Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"canvas",children:[Object(l.jsx)(F,{}),Object(l.jsx)(P,{}),Object(l.jsx)(H,{})]}),Object(l.jsx)(K,{}),Object(l.jsx)(L,{}),Object(l.jsx)(W,{})]})}),Object(l.jsxs)("div",{className:"right_panel",children:[Object(l.jsx)(w,{}),Object(l.jsx)(y,{})]})]})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,234)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),o(e),c(e),r(e),a(e)}))},U=n(27),X=n(35),q=n(10),z=n(2),V={caret:-1,activeId:"id1",order:["id1"],txts:{id1:JSON.stringify(Object(j.convertToRaw)(j.EditorState.createEmpty().getCurrentContent()))},splits:{id1:{slice1:0,slice2:0}},selections:{id1:{anchorKey:0,anchorOffset:0,focusKey:0,focusOffset:0}},notes:{id1:""},views:{id1:!1},positions:{id1:[0,0]},graph:{connections:[],mode:null,selectedNode:null,boxes:{}}};var Q=Object(U.b)({name:"args",initialState:{connection_color:null,tail_selected:!1,tail_id:null},reducers:{updateColor:function(e,t){e.connection_color=t.color,e.tail_selected=!1,e.tail_id=null},updateTail:function(e,t){e.tail_selected=!0,e.tail_id=t.id},resetToDragging:function(e){e.connection_color=null,e.tail_selected=!1,e.tail_id=null}}}),Z=Q.actions,$=(Z.updateColor,Z.updateTail,Z.resetToDragging,Q.reducer),ee=Object(U.a)({reducer:{blocks:m()((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"updateId":return Object(z.a)(Object(z.a)({},e),{},{caret:t.payload.caret,activeId:t.payload.id});case"updateText":return Object(z.a)(Object(z.a)({},e),{},{txts:Object(z.a)(Object(z.a)({},e.txts),{},Object(q.a)({},t.payload.id,t.payload.txt)),splits:Object(z.a)(Object(z.a)({},e.splits),{},Object(q.a)({},t.payload.id,t.payload.split)),selections:Object(z.a)(Object(z.a)({},e.selections),{},Object(q.a)({},t.payload.id,t.payload.selection))});case"updateSelection":return Object(z.a)(Object(z.a)({},e),{},{splits:Object(z.a)(Object(z.a)({},e.splits),{},Object(q.a)({},t.payload.id,t.payload.split)),selections:Object(z.a)(Object(z.a)({},e.selections),{},Object(q.a)({},t.payload.id,t.payload.selection))});case"splitText":var n,o,c=t.payload.id,r=e.order.indexOf(c),a=Object(U.c)(),s=e.splits[c].slice1,i=e.splits[c].slice2,l=Object(X.a)(e.order);l.splice(r+1,0,a);var d=e.positions[c],u=[d[0],d[1]+100];return Object(z.a)(Object(z.a)({},e),{},{activeId:a,order:l,txts:Object(z.a)(Object(z.a)({},e.txts),{},(n={},Object(q.a)(n,c,s),Object(q.a)(n,a,i),n)),splits:Object(z.a)(Object(z.a)({},e.splits),{},(o={},Object(q.a)(o,c,{slice1:0,slice2:0}),Object(q.a)(o,a,{slice1:0,slice2:0}),o)),notes:Object(z.a)(Object(z.a)({},e.notes),{},Object(q.a)({},a,"")),views:Object(z.a)(Object(z.a)({},e.views),{},Object(q.a)({},a,!1)),positions:Object(z.a)(Object(z.a)({},e.positions),{},Object(q.a)({},a,u))});case"mergeText":var b=t.payload.id,p=e.order.indexOf(b);if(0===p)return e;var O=e.order[p-1],f=Object(X.a)(e.order);f.splice(p,1);var g=e.graph.connections.map((function(e){return e.map((function(e){return e===b?O:e}))})).filter((function(e){return e[0]!==e[1]})),y=new Set(g.map((function(e){return e.join()})));g=Object(X.a)(y).map((function(e){return e.split(",")}));var h=Object(j.convertFromRaw)(JSON.parse(e.txts[O])),m=Object(j.convertFromRaw)(JSON.parse(e.txts[b])),v=j.EditorState.createWithContent(m).getSelection(),x=v.getAnchorKey(),S=j.SelectionState.createEmpty("blockkey").merge({anchorKey:x,anchorOffset:0,focusKey:x,focusOffset:0}),C=j.Modifier.replaceWithFragment(m,S,h.getBlockMap());return Object(z.a)(Object(z.a)({},e),{},{activeId:O,order:f,txts:Object(z.a)(Object(z.a)({},e.txts),{},Object(q.a)({},O,JSON.stringify(Object(j.convertToRaw)(C)))),splits:Object(z.a)(Object(z.a)({},e.splits),{},Object(q.a)({},O,{slice1:0,slice2:0})),notes:Object(z.a)(Object(z.a)({},e.notes),{},Object(q.a)({},O,e.notes[O]+e.notes[b])),graph:Object(z.a)(Object(z.a)({},e.graph),{},{connections:g})});case"toggleNote":var A=t.payload.id;return Object(z.a)(Object(z.a)({},e),{},{views:Object(z.a)(Object(z.a)({},e.views),{},Object(q.a)({},A,!e.views[A]))});case"updateNote":var w=t.payload.id,k=document.activeElement;return Object(z.a)(Object(z.a)({},e),{},{notes:Object(z.a)(Object(z.a)({},e.notes),{},Object(q.a)({},w,k.value))});case"updatePosition":var E=t.payload,N=E.id,T=E.x,M=E.y;return Object(z.a)(Object(z.a)({},e),{},{positions:Object(z.a)(Object(z.a)({},e.positions),{},Object(q.a)({},N,[T,M]))});case"setMode":return Object(z.a)(Object(z.a)({},e),{},{graph:Object(z.a)(Object(z.a)({},e.graph),{},{mode:t.payload.label,selectedNode:t.payload.id})});case"resetMode":return Object(z.a)(Object(z.a)({},e),{},{graph:Object(z.a)(Object(z.a)({},e.graph),{},{mode:null,selectedNode:null}),mode:"",id:null});case"setBox":var R=t.payload,D=R.label,K=R.id;return Object(z.a)(Object(z.a)({},e),{},{graph:Object(z.a)(Object(z.a)({},e.graph),{},{boxes:Object(z.a)(Object(z.a)({},e.graph.boxes),{},Object(q.a)({},K,D))})});case"removeBox":var _=t.payload.id,F=Object(z.a)({},e.graph.boxes);return delete F[_],Object(z.a)(Object(z.a)({},e),{},{graph:Object(z.a)(Object(z.a)({},e.graph),{},{boxes:Object(z.a)({},F)})});case"addConnection":return e.graph.connections.filter((function(e){return e.toString()===t.payload.connection.toString()})).length>0&&e.graph.connections.length>0?e:Object(z.a)(Object(z.a)({},e),{},{graph:Object(z.a)(Object(z.a)({},e.graph),{},{connections:[].concat(Object(X.a)(e.graph.connections),[t.payload.connection])})});case"deleteConnection":var B=e.graph.connections.filter((function(e){return e[0]+e[1]+e[2]!==t.payload.id}));return Object(z.a)(Object(z.a)({},e),{},{graph:Object(z.a)(Object(z.a)({},e.graph),{},{connections:B})});default:return e}}),{filter:Object(h.excludeAction)(["updateId","updateCaret","updatePosition","toggleNote","updateNote","resetMode","setMode","updateSelection"])}),args:$}});r.a.render(Object(l.jsx)(a.a,{store:ee,children:Object(l.jsx)(G,{})}),document.getElementById("root")),Y()},49:function(e,t,n){}},[[233,1,2]]]);
//# sourceMappingURL=main.38ebca4a.chunk.js.map